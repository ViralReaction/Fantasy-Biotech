<?xml version="1.0" encoding="utf-8"?>
<Patch>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/QuestScriptDef[defName="BuildMonumentWorker"]/root/nodes/li[@Class="QuestNode_IsTrue"][value="$punishmentOnDestroy"]/node/nodes/li[inSignal="monumentMarker.MonumentDestroyed"]/node/nodes/li[@Class="QuestNode_SetAndRestore"]/node/node/nodes</xpath>
        <value>
            <li Class="QuestNode_Subscript"><def>VR_Util_ConstructCluster</def></li>
        </value>
    </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings</xpath>
    <value>
      <li>threatDescriptionParagraph(threatType==VR_ConstructCluster,threatCount==1,threatSize==1)->(*Threat)a construct cluster(/Threat) will deploy nearby.</li>
      <li>threatDescriptionParagraph(threatType==VR_ConstructCluster,threatCount==2,threatSize==1)->(*Threat)two construct clusters(/Threat) will deploy nearby.</li>
      <li>threatDescriptionParagraph(threatType==VR_ConstructCluster,threatCount==1,threatSize>1)->(*Threat)a construct cluster(/Threat) of [threatSize]x size will deploy nearby.</li>
      <li>threatDescriptionParagraph(threatType==VR_ConstructCluster,threatCount==2,threatSize>1)->(*Threat)two construct clusters(/Threat) of [threatSize]x size will deploy nearby.</li>
    </value>
  </Operation>

  <Operation Class="FantasyBiotech.PatchOperation_ToggleSettings">
    <settings>
      <li>replaceMechanoids</li>
    </settings>
    <active Class="PatchOperationSequence">
      <operations>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Util_Worker"]/root/nodes/li[@Class="QuestNode_Equal"]/node/nodes/li[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_CreateIncidents"]/incidentDef[.="MechCluster"]</xpath>
          <value>
            <incidentDef>VR_ConstructCluster</incidentDef>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Util_Worker"]/root/nodes/li[@Class="QuestNode_Equal"]/node/nodes/li[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_GetFaction"]/allowedHiddenFactions[.="Mechanoid"]</xpath>
          <value>
            <allowedHiddenFactions>VR_Construct</allowedHiddenFactions>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Util_Worker"]/root/nodes/li[@Class="QuestNode_Equal"]/node/nodes/li[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_Set"]/value[.="MechClusters"]</xpath>
          <value>
            <value>VR_ConstructCluster</value>
          </value>
        </li>

      </operations>
    </active>
  </Operation>

  <!-- Change Descriptions -->
  <Operation Class="FantasyBiotech.PatchOperation_ToggleSettings">
    <settings>
      <li>replaceMechanoids</li>
    </settings>
    <active Class="PatchOperationSequence">
      <operations>

        <!-- Rulepack -->
        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"threatsInfoMechClustersSingleHuman")]</xpath>
          <value>
            <li>threatsInfoMechClustersSingleHuman->[lodgers0_nameDef] recently [mechViolation], and has been targeted by a nearby construct swarm.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"threatsInfoMechClustersMultiPrisoners")]</xpath>
          <value>
            <li>threatsInfoMechClustersMultiPrisoners->The prisoners recently [mechViolation], and have been targeted by a nearby construct swarm.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"threatsInfoMechRaidsSingleHuman")]</xpath>
          <value>
            <li>threatsInfoMechRaidsSingleHuman->[lodgers0_nameDef] recently [mechViolation], and has been targeted by a construct forge.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"threatsInfoMechRaidsMultiHuman")]</xpath>
          <value>
            <li>threatsInfoMechRaidsMultiHuman->They recently [mechViolation], and have been targeted by a construct forge.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"mechViolation->angered")]</xpath>
          <value>
            <li>mechViolation->angered a machine persona somehow</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"mechViolation->murdered")]</xpath>
          <value>
            <li>mechViolation->violated an ancient supercomputer terminal</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"mechViolation->attempted to hack")]</xpath>
          <value>
            <li>mechViolation->attempted to hack a mechanoid control node</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/RulePackDef[defName="QuestHospitalityCommon"]/rulePack/rulesStrings/li[contains(.,"mechViolation->attempted to steal")]</xpath>
          <value>
            <li>mechViolation->attempted to steal from an ancient storage site</li>
          </value>
        </li>

        <!-- Hospitality Animal Quest -->
        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfoMechClustersSingleAnimal->")]</xpath>
          <value>
            <li>threatsInfoMechClustersSingleAnimal->For unknown reasons, the [lodgersLabel] has been targeted by a nearby construct swarm.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfoMechClustersMultiAnimal->")]</xpath>
          <value>
            <li>threatsInfoMechClustersMultiAnimal->For unknown reasons, the [lodgersLabelPlural] have been targeted by a nearby construct swarm.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfoMechRaidsSingleAnimal->")]</xpath>
          <value>
            <li>threatsInfoMechRaidsSingleAnimal->For unknown reasons, the [lodgersLabel] has been targeted by a construct forge.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfoMechRaidsMultiAnimal->")]</xpath>
          <value>
            <li>threatsInfoMechRaidsMultiAnimal->For unknown reasons, the [lodgersLabelPlural] have been targeted by a construct forge.</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)->")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nThe animal rescue activists stole [lodgers0_nameDef] from a slaughtering ceremony being held by [enemyFaction_name]. Now the [enemyFaction_pawnsPlural] are coming to seek revenge. If you accept [lodgers0_nameDef], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsSingleAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersSingleAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nUnfortunately, these [lodgersLabelPlural] were recently implicated in the death of a [victim]. Now, [enemyFaction_pawnsPlural] from [enemyFaction_name] are hunting them for ritual revenge. If you accept the [lodgersLabelPlural], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\n[enemyFaction_pawnsPlural] from [enemyFaction_name] are trying to kill poor little [lodgers0_nameDef] to get at [asker_nameDef]. If you accept [lodgers0_nameDef], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nThe [lodgersLabelPlural] are necessary for [asker_nameDef] to fulfill an important trade promise. To provoke conflict, [enemyFaction_name] is sending [enemyFaction_pawnsPlural] after them. If you accept the [lodgersLabelPlural], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\n[lodgers0_nameDef] is a gift promised to [asker_nameDef]'s child for a marriage ceremony. To try to prevent the marriage, [enemyFaction_name] is sending [enemyFaction_pawnsPlural] after [lodgers0_objective]. If you accept [lodgers0_nameDef], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=VR_ConstructCluster)->\n\nUnfortunately, [enemyFaction_name] is hunting the [lodgersLabelPlural] to try to hurt [asker_nameDef] personally. If you accept the [lodgersLabelPlural], [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Animals"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiAnimal] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <!-- Hospitality Animal Quest -->
        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)->")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\n[lodgers0_nameDef] was recently caught [wrongAct]. Seeking revenge, [enemyFaction_pawnsPlural] will come for [lodgers0_objective] as long as [lodgers0_pronoun] is with you. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nThese travelers were recently invited to an important ceremony with [enemyFaction_name], but showed up drunk and profaned the ritual. [enemyFaction_name] is now sending raids after them. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name] is requesting a favor. [asker_possessive] friend, a [lodgers0_age]-year-old [lodgers0_title] named [lodgers0_nameDef], was caught writing vicious insults about [enemyFaction_leader_nameFull]'s [PersonalCharacteristic]. [asker_nameDef] is asking for you to guard [lodgers0_nameDef] for [shuttleDelayTicks_duration], until [asker_pronoun] can smooth over relations with [enemyFaction_name]. Since [enemyFaction_leader_nameDef] is the [enemyFaction_leaderTitle] of [enemyFaction_name], [enemyFaction_leader_pronoun] has sent groups of [enemyFaction_pawnsPlural] to hunt the insulter [lodgers0_nameDef].\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==Raids,enemyFaction==Mechanoid,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==Raids,enemyFaction==VR_Construct,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name] is requesting a favor. [asker_possessive] friend, a [lodgers0_age]-year-old [lodgers0_title] named [lodgers0_nameDef], recently [mechViolation]. [asker_nameDef] is asking for you to guard [lodgers0_nameDef] for [shuttleDelayTicks_duration], until [asker_pronoun] can sooth the construct forge.\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==MechClusters,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount==1,generateThreats==true,threatType==VR_ConstructCluster,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name] is requesting a favor. [asker_possessive] friend, a [lodgers0_age]-year-old [lodgers0_title] named [lodgers0_nameDef], recently [mechViolation]. [asker_nameDef] is asking for you to guard [lodgers0_nameDef] for [shuttleDelayTicks_duration].\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name], recently rescued [lodgersCount] [asker_faction_pawnsPlural] from the prisons of [enemyFaction_name]. [asker_nameDef] wants you to guard them at [map_definite] for [shuttleDelayTicks_duration] until [asker_pronoun] can send a shuttle to collect them. The [asker_faction_pawnsPlural] know secrets about the [secretInfo] of [enemyFaction_name], so they will be hunted.\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==Raids,enemyFaction==Mechanoid,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==Raids,enemyFaction==VR_Construct,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name], recently rescued [lodgersCount] [asker_faction_pawnsPlural] from a cryptosleep vault. [asker_nameDef] wants you to guard them at [map_definite] for [shuttleDelayTicks_duration] until [asker_pronoun] can send a shuttle to collect them. The [asker_faction_pawnsPlural] will be hunted by constructs.\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==MechClusters,priority=1)")]</xpath>
          <value>
            <li>questDescription(asker_factionLeader==True,lodgersCount>=2,generateThreats==true,threatType==VR_ConstructCluster,priority=1)->[asker_nameFull], [asker_faction_leaderTitle] of [asker_faction_name], recently rescued [lodgersCount] [asker_faction_pawnsPlural] from a mechanoid hive's holding pen. [asker_nameDef] wants you to guard them at [map_definite] for [shuttleDelayTicks_duration] until [asker_pronoun] can send a shuttle to collect them. The mechs are tracking their former prisoners.\n\n[threatDescriptionParagraph][allLodgerInfo][goodwillForMood][commonDescEnding]\n\n[joinerEnding]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\n[asker_nameDef]'s enemies have hired [enemyFaction_name] to hunt [asker_objective]. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[asker_nameDef]'s enemies provoked constructs into hunting [asker_objective]. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[asker_nameDef]'s enemies have somehow provoked constructs into hunting [asker_objective]. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->[asker_nameDef] and [asker_possessive] [allyAllies] have been targeted for death and need a safe place to stay until they can purge their court. However, [asker_nameDef]'s enemies have hired [enemyFaction_name] to hunt [asker_objective].\n\n[enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->[asker_nameDef] and [asker_possessive] [allyAllies] have been targeted for death and need a safe place to stay until they can purge their court. However, [asker_nameDef]'s enemies have provoked [enemyFaction_name] into hunting [asker_objective].\n\n[enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Joiners"]/questDescriptionRules/rulesStrings</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==VR_ConstructCluster)->[asker_nameDef] and [asker_possessive] [allyAllies] have been targeted for death and need a safe place to stay until they can purge their court. However, [asker_nameDef]'s enemies have somehow provoked mechanoids into hunting [asker_objective].\n\n[enemyGroupsParagraph]</li>
          </value>
        </li>

        <!-- Hospitality Prisoner Quest -->
        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
           <li>threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\n[lodgers0_nameDef] recently spat on the most loved child of [enemyFaction_leader_nameFull], [enemyFaction_leaderTitle] of [enemyFaction_name]. [enemyFaction_leader_nameDef] will send [enemyFaction_pawnsPlural] to seek revenge on any who would protect [lodgers0_objective]. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsSingleHuman] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo1(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo1(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersSingleHuman] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nThe prisoners committed a string of murders against the [enemyFaction_pawnsPlural] of [enemyFaction_name], and their victims' families will send raids to seek revenge. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==Raids,enemyFaction==VR_ConstructCluster)->\n\nThe prisoners recently [mechViolation], and have been targeted by a construct forge. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo2(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo2(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiPrisoners] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nUnfortunately, [enemyFaction_name] wants to spread the shameful story and is sending raids to break [lodgers0_nameDef] out of jail. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[threatsInfoMechRaidsSingleHuman] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo3(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo3(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersSingleHuman] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nThe prisoners have a paid rescue contract with [enemyFaction_name], so they will send [enemyFaction_pawnsPlural] after you. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\n[asker_nameDef]'s enemies have some provoked a construct forge into hunting the prisoners, so it will send construct attack groups. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo4(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo4(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiPrisoners] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nUnfortunately, [asker_nameDef]'s court rivals are paying [enemyFaction_name] to try to break the lover out and bring the story to light. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==Raids,enemyFaction==VR_Construct)->\n\nUnfortunately, [asker_nameDef]'s court rivals have provoked mechanoids attacks from [enemyFaction_name] to try to break the lover out and bring the story to light. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo5(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo5(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersSingleHuman] [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction!=VR_Construct)->\n\nUnfortunately, [enemyFaction_pawnsPlural] from [enemyFaction_name] revered the vault that the prisoners were extracted from. They'll send raids to seek revenge on anyone who holds them. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==Raids,enemyFaction==Mechanoid)->\n\nUnfortunately, [enemyFaction_pawnsPlural] from [enemyFaction_name] were guarding the vault that the prisoners were extracted from. They'll send constructs to hunt down the lost sleepers. [enemyGroupsParagraph]</li>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/QuestScriptDef[defName="Hospitality_Prisoners"]/questDescriptionRules/rulesStrings/li[contains(.,"threatsInfo6(generateThreats==true,threatType==MechClusters)")]</xpath>
          <value>
            <li>threatsInfo6(generateThreats==true,threatType==VR_ConstructCluster)->\n\n[threatsInfoMechClustersMultiPrisoners] [enemyGroupsParagraph]</li>
          </value>
        </li>

      </operations>
    </active>
  </Operation>

</Patch>